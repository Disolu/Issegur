/*!CK:3545107641!*//*1457388198,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["1wKZF"]); }

__d('MercuryThirdPartyMediaAttachmentContent.react',['cx','ix','CenteredContainer.react','ControlledRefererIFrame.react','FBOverlayBase.react','FBOverlayContainer.react','FBOverlayElement.react','Image.react','ImageBlock.react','MercuryFallbackShareAttachmentTextBlock.react','MercuryShareAttachmentRenderLocations','MercuryThirdPartyMediaReactShape','React','ReactDOM','ResponsiveBlock.react','joinClasses'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k={IMAGE:'image',MEDIA:'media'},l=c('React').createClass({displayName:'MercuryThirdPartyMediaAttachmentContent',propTypes:{attachment:j.object.isRequired,location:j.oneOf(c('MercuryShareAttachmentRenderLocations').getValues()).isRequired,media:c('MercuryThirdPartyMediaReactShape').isRequired},getInitialState:function(){return {showMedia:false,imageDimensions:this._getDimensions(k.IMAGE),mediaDimensions:this._getDimensions(k.MEDIA)};},render:function(){var n=this.props.attachment,o=this.props.location,p=this.props.media,q=(c('MercuryShareAttachmentRenderLocations').CHAT===o?"_49or":'')+(c('MercuryShareAttachmentRenderLocations').MESSENGER===o?' '+"_tih":'')+(!(n&&n.media.image)?' '+"_49ou":'');if(o===c('MercuryShareAttachmentRenderLocations').CHAT){return (c('React').createElement(c('ResponsiveBlock.react'),{onResize:this._updateMediaSize,ref:'wrapper',className:p.chatTextClasses},this._renderMediaFrame(),c('React').createElement(c('ImageBlock.react'),{className:c('joinClasses')(q,this.state.showMedia?"hidden_elem":''),spacing:'medium'},this._renderImageWithPlayButton(),c('React').createElement('div',{className:"_4cra",style:{height:this.state.imageDimensions.height}},c('React').createElement(c('MercuryFallbackShareAttachmentTextBlock.react'),{attachment:n,location:o})))));}else if(o===c('MercuryShareAttachmentRenderLocations').MESSENGER)return (c('React').createElement(c('ResponsiveBlock.react'),{onResize:this._updateMediaSize,ref:'wrapper'},c('React').createElement('div',{className:c('joinClasses')(this.props.className,this._computeClass())},this._renderMediaFrame(),c('React').createElement('div',{className:this.state.showMedia&&!this.props.media.showMediaWithText?"hidden_elem":''},this._renderImageWithPlayButton(),c('React').createElement('div',{className:p.messengerTextClasses},c('React').createElement(c('MercuryFallbackShareAttachmentTextBlock.react'),{attachment:n,location:o}))))));},_updateMediaSize:function(){this.setState({imageDimensions:this._getDimensions(k.IMAGE),mediaDimensions:this._getDimensions(k.MEDIA)});},_computeClass:function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return "_3xn3 _5swn";var n=this._getDimensions(this.state.showMedia?k.MEDIA:k.IMAGE),o=n.height,p=n.width,q=o>p;return "_3xn3"+(m(o,p)&&!q?' '+"_3xn5":'')+(q?' '+"_3xn6":'')+(p>=o?' '+"_3xn7":'');},_getDefaultDimensions:function(n){var o=this.props.media;if(this._locationIsChat()){return n===k.IMAGE?o.chatImageDimensions:o.chatMediaDimensions;}else return n===k.IMAGE?o.messengerImageDimensions:o.messengerMediaDimensions;},_getDimensions:function(n){var o=this._getDefaultDimensions(n),p=c('ReactDOM').findDOMNode(this.refs.wrapper);if(p){var q=o.aspectRatio,r=p.offsetWidth;if(q!=null){return {aspectRatio:q,height:r*q,lockHeight:false,width:r};}else if(o.lockHeight){return {aspectRatio:null,height:o.height,lockHeight:true,width:r};}else return o;}else return o;},_handleClick:function(n){n.preventDefault();this.setState({showMedia:true,iframeWidth:c('ReactDOM').findDOMNode(this.refs.wrapper).offsetWidth});},_renderImageWithPlayButton:function(){var n=this.state.imageDimensions,o={height:n.height,width:n.width};return (c('React').createElement(c('FBOverlayContainer.react'),{className:(this.state.showMedia?"hidden_elem":'')+(' '+"clearfix"),style:o},c('React').createElement(c('FBOverlayBase.react'),null,c('React').createElement(c('Image.react'),{style:o,src:this.props.attachment.media.image})),c('React').createElement(c('FBOverlayElement.react'),null,c('React').createElement(c('CenteredContainer.react'),{vertical:true},c('React').createElement(c('Image.react'),{className:"_4crc",onClick:this._handleClick,src:i('/images/chat/chat_play_icon.png')})))));},_renderMediaFrame:function(){var n=this.state.mediaDimensions;return (c('React').createElement('div',{className:!this.state.showMedia?"hidden_elem":''},c('React').createElement(c('ControlledRefererIFrame.react'),{allowTransparency:true,frameBorder:0,height:n.height,src:this.props.media.mediaSrc,width:n.width,allowFullScreen:true})));},_locationIsChat:function(){return this.props.location===c('MercuryShareAttachmentRenderLocations').CHAT;}});function m(n,o){return n<=300&&o<=300;}f.exports=l;},null);